<%= form_with(model: [@campaign_round.campaign, @campaign_round, @matchup], local: true, class: "space-y-6") do |f| %>
  <% if @matchup.errors.any? %>
    <div class="p-4 rounded border border-red-800/40 bg-red-900/20">
      <h3 class="text-red-300 font-semibold mb-2" style="font-family: 'Cinzel', serif; font-size: 0.85rem;">
        <%= pluralize(@matchup.errors.count, "error") %> impidieron guardar este emparejamiento:
      </h3>
      <ul class="list-disc list-inside mt-2 text-red-300/80" style="font-family: 'Crimson Text', serif;">
        <% @matchup.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Warband Selection -->
  <div class="rounded-lg border border-amber-900/30 bg-gradient-to-b from-stone-900/80 to-stone-950/80 p-6">
    <h3 class="text-amber-200/80 tracking-wider uppercase mb-6" style="font-family: 'Cinzel', serif; font-size: 0.85rem;">
      Seleccion de Warbands
    </h3>

    <div class="grid grid-cols-2 gap-6 mb-6">
      <div>
        <%= f.label :warband_1_id, "Warband 1", class: "block text-amber-200/80 text-sm mb-2 tracking-wider uppercase", style: "font-family: 'Cinzel', serif; font-size: 0.7rem;" %>
        <%= f.collection_select :warband_1_id, @available_warbands, :id, :name,
            { prompt: "Selecciona una warband" },
            class: "w-full bg-stone-900 border border-amber-900/40 rounded py-2 px-3 text-stone-200 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:border-amber-700",
            style: "font-family: 'Crimson Text', serif;" %>
      </div>

      <div>
        <%= f.label :warband_2_id, "Warband 2", class: "block text-amber-200/80 text-sm mb-2 tracking-wider uppercase", style: "font-family: 'Cinzel', serif; font-size: 0.7rem;" %>
        <%= f.collection_select :warband_2_id, @available_warbands, :id, :name,
            { prompt: "Selecciona una warband" },
            class: "w-full bg-stone-900 border border-amber-900/40 rounded py-2 px-3 text-stone-200 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:border-amber-700",
            style: "font-family: 'Crimson Text', serif;" %>
      </div>
    </div>
  </div>

  <!-- Combat Results -->
  <div class="rounded-lg border border-amber-900/30 bg-gradient-to-b from-stone-900/80 to-stone-950/80 p-6">
    <h3 class="text-amber-200/80 tracking-wider uppercase mb-6" style="font-family: 'Cinzel', serif; font-size: 0.85rem;">
      Resultado del Combate
    </h3>

    <div class="grid grid-cols-2 gap-6">
      <!-- Warband 1 Results -->
      <div class="space-y-4">
        <h4 class="text-amber-100 tracking-wider uppercase" style="font-family: 'Cinzel', serif; font-size: 0.8rem;">Warband 1</h4>

        <div>
          <%= f.label :warband_1_score, "Puntos obtenidos", class: "block text-amber-200/80 text-sm mb-2 tracking-wider uppercase", style: "font-family: 'Cinzel', serif; font-size: 0.7rem;" %>
          <%= f.number_field :warband_1_score, class: "w-full bg-stone-900 border border-amber-900/40 rounded py-2 px-3 text-stone-200 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:border-amber-700", style: "font-family: 'Crimson Text', serif;", min: 0 %>
        </div>

        <div>
          <%= f.label :warband_1_casualties, "Bajas sufridas", class: "block text-amber-200/80 text-sm mb-2 tracking-wider uppercase", style: "font-family: 'Cinzel', serif; font-size: 0.7rem;" %>
          <%= f.number_field :warband_1_casualties, class: "w-full bg-stone-900 border border-amber-900/40 rounded py-2 px-3 text-stone-200 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:border-amber-700", style: "font-family: 'Crimson Text', serif;", min: 0 %>
        </div>

        <div class="flex items-center">
          <%= f.check_box :warband_1_primary_objective, class: "h-4 w-4 rounded border-amber-900/40 bg-stone-900 text-amber-600 focus:ring-amber-700 focus:ring-offset-stone-900" %>
          <%= f.label :warband_1_primary_objective, "Objetivo Primario cumplido", class: "ml-2 text-sm text-stone-300", style: "font-family: 'Crimson Text', serif;" %>
        </div>

        <div class="flex items-center">
          <%= f.check_box :warband_1_secondary_objective, class: "h-4 w-4 rounded border-amber-900/40 bg-stone-900 text-amber-600 focus:ring-amber-700 focus:ring-offset-stone-900" %>
          <%= f.label :warband_1_secondary_objective, "Objetivo Secundario cumplido", class: "ml-2 text-sm text-stone-300", style: "font-family: 'Crimson Text', serif;" %>
        </div>
      </div>

      <!-- Warband 2 Results -->
      <div class="space-y-4">
        <h4 class="text-amber-100 tracking-wider uppercase" style="font-family: 'Cinzel', serif; font-size: 0.8rem;">Warband 2</h4>

        <div>
          <%= f.label :warband_2_score, "Puntos obtenidos", class: "block text-amber-200/80 text-sm mb-2 tracking-wider uppercase", style: "font-family: 'Cinzel', serif; font-size: 0.7rem;" %>
          <%= f.number_field :warband_2_score, class: "w-full bg-stone-900 border border-amber-900/40 rounded py-2 px-3 text-stone-200 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:border-amber-700", style: "font-family: 'Crimson Text', serif;", min: 0 %>
        </div>

        <div>
          <%= f.label :warband_2_casualties, "Bajas sufridas", class: "block text-amber-200/80 text-sm mb-2 tracking-wider uppercase", style: "font-family: 'Cinzel', serif; font-size: 0.7rem;" %>
          <%= f.number_field :warband_2_casualties, class: "w-full bg-stone-900 border border-amber-900/40 rounded py-2 px-3 text-stone-200 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:border-amber-700", style: "font-family: 'Crimson Text', serif;", min: 0 %>
        </div>

        <div class="flex items-center">
          <%= f.check_box :warband_2_primary_objective, class: "h-4 w-4 rounded border-amber-900/40 bg-stone-900 text-amber-600 focus:ring-amber-700 focus:ring-offset-stone-900" %>
          <%= f.label :warband_2_primary_objective, "Objetivo Primario cumplido", class: "ml-2 text-sm text-stone-300", style: "font-family: 'Crimson Text', serif;" %>
        </div>

        <div class="flex items-center">
          <%= f.check_box :warband_2_secondary_objective, class: "h-4 w-4 rounded border-amber-900/40 bg-stone-900 text-amber-600 focus:ring-amber-700 focus:ring-offset-stone-900" %>
          <%= f.label :warband_2_secondary_objective, "Objetivo Secundario cumplido", class: "ml-2 text-sm text-stone-300", style: "font-family: 'Crimson Text', serif;" %>
        </div>
      </div>
    </div>

    <div class="mt-6">
      <%= f.label :notes, "Notas adicionales (opcional)", class: "block text-amber-200/80 text-sm mb-2 tracking-wider uppercase", style: "font-family: 'Cinzel', serif; font-size: 0.7rem;" %>
      <%= f.text_area :notes, rows: 3, class: "w-full bg-stone-900 border border-amber-900/40 rounded py-2 px-3 text-stone-200 focus:outline-none focus:ring-2 focus:ring-amber-700 focus:border-amber-700", style: "font-family: 'Crimson Text', serif;", placeholder: "Notas sobre el combate, eventos especiales, etc." %>
    </div>
  </div>

  <div class="flex justify-end space-x-4 pt-2">
    <%= link_to "Cancelar", campaign_campaign_round_path(@campaign_round.campaign, @campaign_round),
        class: "text-stone-400 hover:text-amber-400 transition-colors tracking-wider uppercase",
        style: "font-family: 'Cinzel', serif; font-size: 0.75rem;" %>
    <%= f.submit "Guardar Resultado",
        class: "px-6 py-2.5 bg-gradient-to-b from-amber-700 to-amber-900 text-amber-100 rounded border border-amber-600/50 hover:from-amber-600 hover:to-amber-800 transition-all shadow-lg shadow-amber-900/30 cursor-pointer",
        style: "font-family: 'Cinzel', serif; letter-spacing: 0.1em; text-transform: uppercase; font-size: 0.75rem;" %>
  </div>
<% end %>
